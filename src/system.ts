import { resize, start, stop } from '@cve-ts/player'
import CveControl from './core/control'

export default class SystemControl extends CveControl {
  constructor() {
    super()
  }

  start(url: string) {
    start(url)
  }
  stop() {
    stop()
  }
  setResolution(width: number, height: number, callback?: CveCallback) {
    const Data = { Width: width, Height: height }
    return this.sendCommand({ Command: 'SetResolution', Data }, callback)
  }
  setFramerateCap(rate: number, callback?: CveCallback) {
    return this.sendCommand({ Command: 'SetFramerateCap', Data: rate }, callback)
  }
  setBandwidthCap(bandwidth: number, callback?: CveCallback) {
    return this.sendCommand({ Command: 'SetBandwidthCap', Data: bandwidth }, callback)
  }
  setDegradationPreference(
    degradationPreference: RTCDegradationPreference,
    callback?: CveCallback
  ) {
    return this.sendCommand(
      {
        Console: `PixelStreaming.WebRTC.DegradationPreference ${degradationPreference}`,
      },
      callback
    )
  }
  resetPlayerSize() {
    resize(undefined)
  }
  restartLevel(callback?: CveCallback) {
    return this.sendCommand({ Command: 'RestartLevel' }, callback)
  }
  openLevel(levelName: string, sceneName: string | undefined, callback?: CveCallback) {
    const Data = { LevelName: levelName, SceneName: sceneName }
    return this.sendCommand({ Command: 'OpenLevel', Data }, callback)
  }
  toggleFps(callback?: CveCallback) {
    return this.sendCommand({ Command: 'ToggleFPS' }, callback)
  }
  setVolume(volume: number, callback?: CveCallback) {
    return this.sendCommand({ Command: 'SetVolume', Data: volume }, callback)
  }
  mute(callback?: CveCallback) {
    return this.sendCommand({ Command: 'Mute' }, callback)
  }
  unmute(callback?: CveCallback) {
    return this.sendCommand({ Command: 'Unmute' }, callback)
  }
}

export { SystemControl }
